
<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academia 4.3.1">
  <meta name="generator" content="Hugo 0.70.0" />

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="My favorite">

  
  
  
    
  
  <meta name="description" content="效果 包结构 导入依赖 pom.xml &lt;project xmlns=&#34;http://maven.apache.org/POM/4.0.0&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;!-- 继承springboot父工程 --&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;1.5.4.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;groupId&gt;com.yzg&lt;/groupId&gt; &lt;artifactId&gt;springboot-shiro&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;!-- 导入thymeleaf依赖 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- 导入WEB支持 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- 导入shiro依赖 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt; &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt; &lt;/dependency&gt; &lt;!-- 导入阿里巴巴连接池 --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.0.9&lt;/version&gt; &lt;/dependency&gt; &lt;!-- 导入MyBatis启动器 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- 导入mysql连接数据库驱动 --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;properties&gt; &lt;!-- 修改JDK版本 --&gt; &lt;java.">

  
  <link rel="alternate" hreflang="en-us" href="https://academia-hugo.netlify.com/notes/spring-shiro-thymeleaf/%E7%AE%80%E5%8D%95%E7%99%BB%E5%BD%95/">

  


  

  
  
  
  <meta name="theme-color" content="#fc6f5c">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Open+Sans|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academia.min.adccb3b334fd9406ba3e6667ec8e7903.css">

  

  
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://academia-hugo.netlify.com/notes/spring-shiro-thymeleaf/%E7%AE%80%E5%8D%95%E7%99%BB%E5%BD%95/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="GUAN-BLOG">
  <meta property="og:url" content="https://academia-hugo.netlify.com/notes/spring-shiro-thymeleaf/%E7%AE%80%E5%8D%95%E7%99%BB%E5%BD%95/">
  <meta property="og:title" content="spring&#43;shiro&#43;MyBatis实现登录认证 | GUAN-BLOG">
  <meta property="og:description" content="效果 包结构 导入依赖 pom.xml &lt;project xmlns=&#34;http://maven.apache.org/POM/4.0.0&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;!-- 继承springboot父工程 --&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;1.5.4.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;groupId&gt;com.yzg&lt;/groupId&gt; &lt;artifactId&gt;springboot-shiro&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;!-- 导入thymeleaf依赖 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- 导入WEB支持 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- 导入shiro依赖 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt; &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt; &lt;/dependency&gt; &lt;!-- 导入阿里巴巴连接池 --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.0.9&lt;/version&gt; &lt;/dependency&gt; &lt;!-- 导入MyBatis启动器 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- 导入mysql连接数据库驱动 --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;properties&gt; &lt;!-- 修改JDK版本 --&gt; &lt;java."><meta property="og:image" content="https://academia-hugo.netlify.com/img/icon-192.png">
  <meta property="twitter:image" content="https://academia-hugo.netlify.com/img/icon-192.png"><meta property="og:locale" content="en-us">
  
  
  
  

  


  





  <title>spring&#43;shiro&#43;MyBatis实现登录认证 | GUAN-BLOG</title>

</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">GUAN-BLOG</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation"><span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#gallery"><span>gallery</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/notes/"><span>Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        

        

        

        

      </ul>

    </div>
  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/notes/spring-shiro-thymeleaf/">spring&#43;shiro&#43;thymeleaf用户登录授权</a>
    <ul class="nav docs-sidenav">
      
      <li class="active">
        <a href="/notes/spring-shiro-thymeleaf/%E7%AE%80%E5%8D%95%E7%99%BB%E5%BD%95/">spring&#43;shiro&#43;MyBatis实现登录认证</a>
      </li>
      
      <li >
        <a href="/notes/spring-shiro-thymeleaf/shiro%E5%B8%B8%E8%A7%81%E7%9A%84%E5%BC%82%E5%B8%B8/">shiro常见的异常</a>
      </li>
      
      <li >
        <a href="/notes/spring-shiro-thymeleaf/shiro%E5%86%85%E7%BD%AE%E8%BF%87%E6%BB%A4%E5%99%A8/">shiro内置过滤器</a>
      </li>
      
      <li >
        <a href="/notes/spring-shiro-thymeleaf/shiro&#43;thymeleaf%E6%8E%88%E6%9D%83/">shiro&#43;Thymeleaf授权</a>
      </li>
      
      <li >
        <a href="/notes/spring-shiro-thymeleaf/shiro%E7%94%A8%E6%88%B7%E5%90%8D%E6%89%8B%E6%9C%BA%E5%A4%9Arealm%E8%AE%A4%E8%AF%81/">shiro用户名手机多Realm认证</a>
      </li>
      
      <li >
        <a href="/notes/spring-shiro-thymeleaf/shiro%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8Cmd5%E5%8A%A0%E5%AF%86/">shiro登录注册MD5加密</a>
      </li>
      
      <li >
        <a href="/notes/spring-shiro-thymeleaf/shiro%E6%97%A0%E6%B3%95%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5service/">shiro无法依赖注入Service</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#效果">效果</a></li>
    <li><a href="#包结构">包结构</a></li>
    <li><a href="#导入依赖">导入依赖</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#编写applicationproperties配置文件">编写application.properties配置文件</a></li>
    <li><a href="#编写shiro配置类">编写shiro配置类</a>
      <ul>
        <li><a href="#shiroconfigjavajie">ShiroConfig.javajie</a></li>
      </ul>
    </li>
    <li><a href="#自定义realm">自定义realm</a>
      <ul>
        <li><a href="#userrealmjava">UserRealm。java</a></li>
      </ul>
    </li>
    <li><a href="#数据库设计">数据库设计</a></li>
    <li><a href="#编写user实体类">编写User实体类</a></li>
    <li><a href="#编写mapper层">编写mapper层</a>
      <ul>
        <li><a href="#usermapperjava">UserMapper.java</a></li>
        <li><a href="#usermapperxml">UserMapper.xml</a></li>
      </ul>
    </li>
    <li><a href="#编写service层">编写service层</a>
      <ul>
        <li><a href="#iuserservicejava">IUserService.java</a></li>
        <li><a href="#userserviceimpljava">UserServiceImpl.java</a></li>
      </ul>
    </li>
    <li><a href="#编写controller层">编写controller层</a>
      <ul>
        <li><a href="#usercontroller">UserController</a></li>
      </ul>
    </li>
    <li><a href="#编写界面">编写界面</a>
      <ul>
        <li><a href="#首页">首页</a></li>
        <li><a href="#loginhtml">login.html</a></li>
        <li><a href="#用户添加">用户添加</a></li>
        <li><a href="#用户修改">用户修改</a></li>
      </ul>
    </li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article" itemscope itemtype="http://schema.org/Article">

        <div class="docs-article-container">
          <h1 itemprop="name">spring&#43;shiro&#43;MyBatis实现登录认证</h1>

          <div class="article-style" itemprop="articleBody">
            <h2 id="效果">效果</h2>
<p><img src="/img/shiro/5.gif" alt=""></p>
<h2 id="包结构">包结构</h2>
<p><img src="/img/shiro/3.jpg" alt=""></p>
<h2 id="导入依赖">导入依赖</h2>
<h4 id="pomxml">pom.xml</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">&lt;</span>project xmlns<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
	xmlns<span style="color:#f92672">:</span>xsi<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
	xsi<span style="color:#f92672">:</span>schemaLocation<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>

	<span style="color:#f92672">&lt;</span>modelVersion<span style="color:#f92672">&gt;</span>4<span style="color:#f92672">.</span><span style="color:#a6e22e">0</span><span style="color:#f92672">.</span><span style="color:#a6e22e">0</span><span style="color:#f92672">&lt;/</span>modelVersion<span style="color:#f92672">&gt;</span>

	<span style="color:#f92672">&lt;!--</span> 继承springboot父工程 <span style="color:#f92672">--&gt;</span>
	<span style="color:#f92672">&lt;</span>parent<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>org<span style="color:#f92672">.</span><span style="color:#a6e22e">springframework</span><span style="color:#f92672">.</span><span style="color:#a6e22e">boot</span><span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>spring<span style="color:#f92672">-</span>boot<span style="color:#f92672">-</span>starter<span style="color:#f92672">-</span>parent<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;</span>version<span style="color:#f92672">&gt;</span>1<span style="color:#f92672">.</span><span style="color:#a6e22e">5</span><span style="color:#f92672">.</span><span style="color:#a6e22e">4</span><span style="color:#f92672">.</span><span style="color:#a6e22e">RELEASE</span><span style="color:#f92672">&lt;/</span>version<span style="color:#f92672">&gt;</span>
	<span style="color:#f92672">&lt;/</span>parent<span style="color:#f92672">&gt;</span>

	<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>com<span style="color:#f92672">.</span><span style="color:#a6e22e">yzg</span><span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
	<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>springboot<span style="color:#f92672">-</span>shiro<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
	<span style="color:#f92672">&lt;</span>version<span style="color:#f92672">&gt;</span>0<span style="color:#f92672">.</span><span style="color:#a6e22e">0</span><span style="color:#f92672">.</span><span style="color:#a6e22e">1</span><span style="color:#f92672">-</span>SNAPSHOT<span style="color:#f92672">&lt;/</span>version<span style="color:#f92672">&gt;</span>

	<span style="color:#f92672">&lt;</span>dependencies<span style="color:#f92672">&gt;</span>

		<span style="color:#f92672">&lt;!--</span> 导入thymeleaf依赖 <span style="color:#f92672">--&gt;</span>
		<span style="color:#f92672">&lt;</span>dependency<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>org<span style="color:#f92672">.</span><span style="color:#a6e22e">springframework</span><span style="color:#f92672">.</span><span style="color:#a6e22e">boot</span><span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>spring<span style="color:#f92672">-</span>boot<span style="color:#f92672">-</span>starter<span style="color:#f92672">-</span>thymeleaf<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;/</span>dependency<span style="color:#f92672">&gt;</span>

		<span style="color:#f92672">&lt;!--</span> 导入WEB支持 <span style="color:#f92672">--&gt;</span>
		<span style="color:#f92672">&lt;</span>dependency<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>org<span style="color:#f92672">.</span><span style="color:#a6e22e">springframework</span><span style="color:#f92672">.</span><span style="color:#a6e22e">boot</span><span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>spring<span style="color:#f92672">-</span>boot<span style="color:#f92672">-</span>starter<span style="color:#f92672">-</span>web<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;/</span>dependency<span style="color:#f92672">&gt;</span>

		<span style="color:#f92672">&lt;!--</span> 导入shiro依赖 <span style="color:#f92672">--&gt;</span>
		<span style="color:#f92672">&lt;</span>dependency<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>org<span style="color:#f92672">.</span><span style="color:#a6e22e">apache</span><span style="color:#f92672">.</span><span style="color:#a6e22e">shiro</span><span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>shiro<span style="color:#f92672">-</span>spring<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>version<span style="color:#f92672">&gt;</span>1<span style="color:#f92672">.</span><span style="color:#a6e22e">4</span><span style="color:#f92672">.</span><span style="color:#a6e22e">0</span><span style="color:#f92672">&lt;/</span>version<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;/</span>dependency<span style="color:#f92672">&gt;</span>



		<span style="color:#f92672">&lt;!--</span> 导入阿里巴巴连接池 <span style="color:#f92672">--&gt;</span>
		<span style="color:#f92672">&lt;</span>dependency<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>com<span style="color:#f92672">.</span><span style="color:#a6e22e">alibaba</span><span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>druid<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>version<span style="color:#f92672">&gt;</span>1<span style="color:#f92672">.</span><span style="color:#a6e22e">0</span><span style="color:#f92672">.</span><span style="color:#a6e22e">9</span><span style="color:#f92672">&lt;/</span>version<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;/</span>dependency<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;!--</span> 导入MyBatis启动器 <span style="color:#f92672">--&gt;</span>
		<span style="color:#f92672">&lt;</span>dependency<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>org<span style="color:#f92672">.</span><span style="color:#a6e22e">mybatis</span><span style="color:#f92672">.</span><span style="color:#a6e22e">spring</span><span style="color:#f92672">.</span><span style="color:#a6e22e">boot</span><span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>mybatis<span style="color:#f92672">-</span>spring<span style="color:#f92672">-</span>boot<span style="color:#f92672">-</span>starter<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>version<span style="color:#f92672">&gt;</span>1<span style="color:#f92672">.</span><span style="color:#a6e22e">1</span><span style="color:#f92672">.</span><span style="color:#a6e22e">1</span><span style="color:#f92672">&lt;/</span>version<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;/</span>dependency<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;!--</span> 导入mysql连接数据库驱动 <span style="color:#f92672">--&gt;</span>
		<span style="color:#f92672">&lt;</span>dependency<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>mysql<span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
			<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>mysql<span style="color:#f92672">-</span>connector<span style="color:#f92672">-</span>java<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;/</span>dependency<span style="color:#f92672">&gt;</span>
	<span style="color:#f92672">&lt;/</span>dependencies<span style="color:#f92672">&gt;</span>
	<span style="color:#f92672">&lt;</span>properties<span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;!--</span> 修改JDK版本 <span style="color:#f92672">--&gt;</span>
		<span style="color:#f92672">&lt;</span>java<span style="color:#f92672">.</span><span style="color:#a6e22e">version</span><span style="color:#f92672">&gt;</span>1<span style="color:#f92672">.</span><span style="color:#a6e22e">8</span><span style="color:#f92672">&lt;/</span>java<span style="color:#f92672">.</span><span style="color:#a6e22e">version</span><span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;!--</span> 修改thymeleaf版本 <span style="color:#f92672">--&gt;</span>
		<span style="color:#f92672">&lt;</span>thymeleaf<span style="color:#f92672">.</span><span style="color:#a6e22e">version</span><span style="color:#f92672">&gt;</span>3<span style="color:#f92672">.</span><span style="color:#a6e22e">0</span><span style="color:#f92672">.</span><span style="color:#a6e22e">2</span><span style="color:#f92672">.</span><span style="color:#a6e22e">RELEASE</span><span style="color:#f92672">&lt;/</span>thymeleaf<span style="color:#f92672">.</span><span style="color:#a6e22e">version</span><span style="color:#f92672">&gt;</span>
		<span style="color:#f92672">&lt;</span>thymeleaf<span style="color:#f92672">-</span>layout<span style="color:#f92672">-</span>dialect<span style="color:#f92672">.</span><span style="color:#a6e22e">version</span><span style="color:#f92672">&gt;</span>2<span style="color:#f92672">.</span><span style="color:#a6e22e">1</span><span style="color:#f92672">.</span><span style="color:#a6e22e">1</span><span style="color:#f92672">&lt;/</span>thymeleaf<span style="color:#f92672">-</span>layout<span style="color:#f92672">-</span>dialect<span style="color:#f92672">.</span><span style="color:#a6e22e">version</span><span style="color:#f92672">&gt;</span>
	<span style="color:#f92672">&lt;/</span>properties<span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;/</span>project<span style="color:#f92672">&gt;</span>
</code></pre></div><h2 id="编写applicationproperties配置文件">编写application.properties配置文件</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">server<span style="color:#f92672">.</span><span style="color:#a6e22e">port</span><span style="color:#f92672">=</span>8081

spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">driver</span><span style="color:#f92672">-</span>class<span style="color:#f92672">-</span>name<span style="color:#f92672">=</span>com<span style="color:#f92672">.</span><span style="color:#a6e22e">mysql</span><span style="color:#f92672">.</span><span style="color:#a6e22e">jdbc</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Driver</span>
spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">url</span><span style="color:#f92672">=</span>jdbc<span style="color:#f92672">:</span>mysql<span style="color:#f92672">:</span><span style="color:#75715e">//localhost:3306/spring_shiro?useUnicode=true&amp;characterEncoding=utf8&amp;characterSetResults=utf8&amp;useSSL=false&amp;serverTimezone=GMT
</span><span style="color:#75715e"></span>spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">username</span><span style="color:#f92672">=</span>数据库账号
spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">password</span><span style="color:#f92672">=</span>数据库密码

spring<span style="color:#f92672">.</span><span style="color:#a6e22e">datasource</span><span style="color:#f92672">.</span><span style="color:#a6e22e">type</span><span style="color:#f92672">=</span>com<span style="color:#f92672">.</span><span style="color:#a6e22e">alibaba</span><span style="color:#f92672">.</span><span style="color:#a6e22e">druid</span><span style="color:#f92672">.</span><span style="color:#a6e22e">pool</span><span style="color:#f92672">.</span><span style="color:#a6e22e">DruidDataSource</span>

mybatis<span style="color:#f92672">.</span><span style="color:#a6e22e">type</span><span style="color:#f92672">-</span>aliases<span style="color:#f92672">-</span>package<span style="color:#f92672">=</span>com<span style="color:#f92672">.</span><span style="color:#a6e22e">yzg</span><span style="color:#f92672">.</span><span style="color:#a6e22e">domain</span>


</code></pre></div><h2 id="编写shiro配置类">编写shiro配置类</h2>
<ul>
<li><strong>创建ShiroFilterFactoryBean</strong></li>
<li><strong>创建DefaultWebSecurityManager</strong></li>
<li><strong>创建Realm</strong></li>
</ul>
<h3 id="shiroconfigjavajie">ShiroConfig.javajie</h3>
<p>shiroFilterFactoryBean.setLoginUrl(&quot;/tologin&rdquo;);是只定义登录连接，没有授权登录的都会请求这个这个链接</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Configuration</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ShiroConfig</span> <span style="color:#f92672">{</span>
	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * 创建ShiroFilterFactoryBean
</span><span style="color:#75715e">	 */</span>
	<span style="color:#a6e22e">@Bean</span>
	<span style="color:#66d9ef">public</span> ShiroFilterFactoryBean <span style="color:#a6e22e">getShiroFilterFactoryBean</span><span style="color:#f92672">(</span>
			<span style="color:#a6e22e">@Qualifier</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;securityManager&#34;</span><span style="color:#f92672">)</span> DefaultWebSecurityManager securityManager<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		ShiroFilterFactoryBean shiroFilterFactoryBean <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ShiroFilterFactoryBean<span style="color:#f92672">();</span>
		Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;</span>filterMap<span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> LinkedHashMap<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span>String<span style="color:#f92672">&gt;();</span>
		
		<span style="color:#75715e">//放行
</span><span style="color:#75715e"></span>		filterMap<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;anon&#34;</span><span style="color:#f92672">);</span>
		filterMap<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/testThymeleaf&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;anon&#34;</span><span style="color:#f92672">);</span>
		<span style="color:#75715e">//拦截
</span><span style="color:#75715e"></span>		filterMap<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/*&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;authc&#34;</span><span style="color:#f92672">);</span>

		<span style="color:#75715e">//修改用户登录界面路径
</span><span style="color:#75715e"></span>		shiroFilterFactoryBean<span style="color:#f92672">.</span><span style="color:#a6e22e">setLoginUrl</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/tologin&#34;</span><span style="color:#f92672">);</span>
		
		shiroFilterFactoryBean<span style="color:#f92672">.</span><span style="color:#a6e22e">setFilterChainDefinitionMap</span><span style="color:#f92672">(</span>filterMap<span style="color:#f92672">);</span>
		shiroFilterFactoryBean<span style="color:#f92672">.</span><span style="color:#a6e22e">setSecurityManager</span><span style="color:#f92672">(</span>securityManager<span style="color:#f92672">);</span>
		<span style="color:#66d9ef">return</span> shiroFilterFactoryBean<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
	
	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * 创建DefaultWebSecurityManager
</span><span style="color:#75715e">	 */</span>
	<span style="color:#a6e22e">@Bean</span><span style="color:#f92672">(</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;securityManager&#34;</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">public</span> DefaultWebSecurityManager <span style="color:#a6e22e">getDefaultWebSecurityManager</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Qualifier</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;userRealm&#34;</span><span style="color:#f92672">)</span> UserRealm userRealm<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		DefaultWebSecurityManager securityManager <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DefaultWebSecurityManager<span style="color:#f92672">();</span>
		securityManager<span style="color:#f92672">.</span><span style="color:#a6e22e">setRealm</span><span style="color:#f92672">(</span>userRealm<span style="color:#f92672">);</span>
		<span style="color:#66d9ef">return</span> securityManager<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
	
	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * 创建Realm
</span><span style="color:#75715e">	 */</span>
	<span style="color:#a6e22e">@Bean</span><span style="color:#f92672">(</span>name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;userRealm&#34;</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">public</span> UserRealm <span style="color:#a6e22e">getRealm</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> UserRealm<span style="color:#f92672">();</span>
	<span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><h2 id="自定义realm">自定义realm</h2>
<ul>
<li>
<p><strong>doGetAuthorizationInfo()   执行授权逻辑</strong></p>
</li>
<li>
<p><strong>doGetAuthenticationInfo()   执行认证逻辑</strong></p>
</li>
</ul>
<h3 id="userrealmjava">UserRealm。java</h3>
<p>SimpleAuthenticationInfo()第一个参数存放的是token相当于session第二个参数存放的是存放的是从数据库查询到的密码，在Realm中只需要输入界面用户输入的token和查询数据库获得的User对象shiro会帮你比对用户名和密码。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserRealm</span> <span style="color:#66d9ef">extends</span> AuthorizingRealm<span style="color:#f92672">{</span>
	<span style="color:#a6e22e">@Autowired</span>
	<span style="color:#66d9ef">private</span> IUserService userService<span style="color:#f92672">;</span>
	<span style="color:#a6e22e">@Override</span>
	<span style="color:#66d9ef">protected</span> AuthorizationInfo <span style="color:#a6e22e">doGetAuthorizationInfo</span><span style="color:#f92672">(</span>PrincipalCollection principals<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;执行授权逻辑&#34;</span><span style="color:#f92672">);</span>
	    <span style="color:#66d9ef">return</span>  <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>t
	<span style="color:#f92672">}</span>

	<span style="color:#a6e22e">@Override</span>
	<span style="color:#66d9ef">protected</span> AuthenticationInfo <span style="color:#a6e22e">doGetAuthenticationInfo</span><span style="color:#f92672">(</span>AuthenticationToken agrs<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> AuthenticationException <span style="color:#f92672">{</span>
		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;执行认证逻辑&#34;</span><span style="color:#f92672">);</span>	
		<span style="color:#75715e">//编写shiro判断逻辑
</span><span style="color:#75715e"></span>		<span style="color:#75715e">//1.判断用户名
</span><span style="color:#75715e"></span>		UsernamePasswordToken token<span style="color:#f92672">=(</span>UsernamePasswordToken<span style="color:#f92672">)</span>agrs<span style="color:#f92672">;</span>
		User u<span style="color:#f92672">=</span>userService<span style="color:#f92672">.</span><span style="color:#a6e22e">findByUsername</span><span style="color:#f92672">(</span>token<span style="color:#f92672">.</span><span style="color:#a6e22e">getUsername</span><span style="color:#f92672">());</span>
		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;用户&#34;</span><span style="color:#f92672">+</span>u<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;登录&#34;</span><span style="color:#f92672">);</span>
		<span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>u<span style="color:#f92672">==</span><span style="color:#66d9ef">null</span><span style="color:#f92672">||</span>u<span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
			<span style="color:#75715e">//用户名不存在
</span><span style="color:#75715e"></span>			<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span>
		<span style="color:#75715e">//password是数据库的密码
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> SimpleAuthenticationInfo<span style="color:#f92672">(</span>u<span style="color:#f92672">,</span>u<span style="color:#f92672">.</span><span style="color:#a6e22e">getPassword</span><span style="color:#f92672">(),</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">);</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="数据库设计">数据库设计</h2>
<p><img src="/img/shiro/3.jpg" alt=""></p>
<h2 id="编写user实体类">编写User实体类</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">User</span> <span style="color:#f92672">{</span>
<span style="color:#66d9ef">private</span> Integer id<span style="color:#f92672">;</span>
<span style="color:#66d9ef">private</span> String username<span style="color:#f92672">;</span>
<span style="color:#66d9ef">private</span> String password<span style="color:#f92672">;</span>
<span style="color:#66d9ef">private</span> String name<span style="color:#f92672">;</span>
<span style="color:#66d9ef">private</span> String perms<span style="color:#f92672">;</span>
<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getPerms</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">return</span> perms<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setPerms</span><span style="color:#f92672">(</span>String perms<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">perms</span> <span style="color:#f92672">=</span> perms<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> Integer <span style="color:#a6e22e">getId</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">return</span> id<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setId</span><span style="color:#f92672">(</span>Integer id<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> id<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getUsername</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">return</span> username<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUsername</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">username</span> <span style="color:#f92672">=</span> username<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getPassword</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">return</span> password<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setPassword</span><span style="color:#f92672">(</span>String password<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">password</span> <span style="color:#f92672">=</span> password<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getName</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">return</span> name<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setName</span><span style="color:#f92672">(</span>String name<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

</code></pre></div><h2 id="编写mapper层">编写mapper层</h2>
<h3 id="usermapperjava">UserMapper.java</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserMapper</span> <span style="color:#f92672">{</span>
	
	User <span style="color:#a6e22e">findByUsername</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">);</span>

<span style="color:#f92672">}</span>
</code></pre></div><h3 id="usermapperxml">UserMapper.xml</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">&lt;?</span>xml version<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1.0&#34;</span> encoding<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span> <span style="color:#f92672">?&gt;</span>
<span style="color:#f92672">&lt;!</span>DOCTYPE mapper
PUBLIC <span style="color:#e6db74">&#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;</span>
<span style="color:#e6db74">&#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;</span>mapper namespace<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;com.yzg.mapper.UserMapper&#34;</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;</span>select id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;findByUsername&#34;</span> parameterType<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;string&#34;</span> resultType<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;user&#34;</span><span style="color:#f92672">&gt;</span>
SELECT
	id<span style="color:#f92672">,</span>
	name<span style="color:#f92672">,</span>
	username<span style="color:#f92672">,</span>
	password<span style="color:#f92672">,</span>
	perms
FROM
	user
WHERE
	username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${value}&#34;</span>
<span style="color:#f92672">&lt;/</span>select<span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;/</span>mapper<span style="color:#f92672">&gt;</span>
</code></pre></div><h2 id="编写service层">编写service层</h2>
<h3 id="iuserservicejava">IUserService.java</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IUserService</span> <span style="color:#f92672">{</span>
	User <span style="color:#a6e22e">findByUsername</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="userserviceimpljava">UserServiceImpl.java</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Service</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserServiceImpl</span> <span style="color:#66d9ef">implements</span> IUserService<span style="color:#f92672">{</span>
	<span style="color:#a6e22e">@Autowired</span>
	<span style="color:#66d9ef">private</span> UserMapper userMapper<span style="color:#f92672">;</span>
	
	<span style="color:#a6e22e">@Override</span>
	<span style="color:#66d9ef">public</span> User <span style="color:#a6e22e">findByUsername</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">findByUsername</span><span style="color:#f92672">(</span>username<span style="color:#f92672">);</span>
	<span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><h2 id="编写controller层">编写controller层</h2>
<p>shiro是通过捕获异常的方式判断进行登录认证的</p>
<h3 id="usercontroller">UserController</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Controller</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserController</span> <span style="color:#f92672">{</span>
	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * 登录逻辑处理
</span><span style="color:#75715e">	 * @return
</span><span style="color:#75715e">	 */</span>
	<span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login&#34;</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">login</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">,</span> String password<span style="color:#f92672">,</span> Model model<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		Subject subject <span style="color:#f92672">=</span> SecurityUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">getSubject</span><span style="color:#f92672">();</span>
		UsernamePasswordToken token <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UsernamePasswordToken<span style="color:#f92672">(</span>username<span style="color:#f92672">,</span> password<span style="color:#f92672">);</span>
		<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
			subject<span style="color:#f92672">.</span><span style="color:#a6e22e">login</span><span style="color:#f92672">(</span>token<span style="color:#f92672">);</span>
			<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;redirect:/testThymeleaf&#34;</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>UnknownAccountException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;用户名不存在&#34;</span><span style="color:#f92672">);</span>
			model<span style="color:#f92672">.</span><span style="color:#a6e22e">addAttribute</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;msg&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;用户名不存在&#34;</span><span style="color:#f92672">);</span>
			<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;login&#34;</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span><span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IncorrectCredentialsException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;密码错误&#34;</span><span style="color:#f92672">);</span>
			model<span style="color:#f92672">.</span><span style="color:#a6e22e">addAttribute</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;msg&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;密码错误&#34;</span><span style="color:#f92672">);</span>
			<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;login&#34;</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span>
	<span style="color:#f92672">}</span>
	<span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/test&#34;</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">testThymeleaf</span><span style="color:#f92672">(</span>Model model<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;test&#34;</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
	<span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/user/add&#34;</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">add</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;user/add&#34;</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
	<span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/user/update&#34;</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">update</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;user/update&#34;</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
	<span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/tologin&#34;</span><span style="color:#f92672">)</span>
	<span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">tologin</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;login&#34;</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

</code></pre></div><h2 id="编写界面">编写界面</h2>
<h3 id="首页">首页</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;&lt;/<span style="color:#f92672">meta</span>&gt;
&lt;<span style="color:#f92672">title</span>&gt;首页&lt;/<span style="color:#f92672">title</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;
&lt;<span style="color:#f92672">h3</span> <span style="color:#a6e22e">th:text</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;${name}&#34;</span>&gt;&lt;/<span style="color:#f92672">h3</span>&gt;
&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;user/add&#34;</span>&gt;用户添加&lt;/<span style="color:#f92672">a</span>&gt;
&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;user/update&#34;</span>&gt;用户修改&lt;/<span style="color:#f92672">a</span>&gt;
&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tologin&#34;</span>&gt;登錄&lt;/<span style="color:#f92672">a</span>&gt;
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><h3 id="loginhtml">login.html</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;&lt;/<span style="color:#f92672">meta</span>&gt;
&lt;<span style="color:#f92672">title</span>&gt;用户登录&lt;/<span style="color:#f92672">title</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;
&lt;<span style="color:#f92672">h3</span>&gt;用户登录&lt;/<span style="color:#f92672">h3</span>&gt;
&lt;<span style="color:#f92672">form</span> <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post&#34;</span> <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;login&#34;</span>&gt;
&lt;<span style="color:#f92672">h3</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;color:red&#34;</span> <span style="color:#a6e22e">th:text</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;${msg}&#34;</span>&gt;&lt;/<span style="color:#f92672">h3</span>&gt;
用户名：&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;username&#34;</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
密码：&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;password&#34;</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
&lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;submit&#34;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;登录&#34;</span>&gt;
&lt;/<span style="color:#f92672">form</span>&gt;
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><h3 id="用户添加">用户添加</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
&lt;<span style="color:#f92672">title</span>&gt;用户添加&lt;/<span style="color:#f92672">title</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;
用户添加
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><h3 id="用户修改">用户修改</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
&lt;<span style="color:#f92672">title</span>&gt;用户修改&lt;/<span style="color:#f92672">title</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;
用户修改
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><!-- raw HTML omitted -->

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/notes/spring-shiro-thymeleaf/shiro%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8Cmd5%E5%8A%A0%E5%AF%86/" rel="next">shiro登录注册MD5加密</a>
  </div>
  
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          Last updated on Jan 1, 0001
        </div>

      </article>

      <footer class="site-footer">
  <script src="/js/clipboard.js"></script>
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        
        <p class="powered-by">
          <a href="/privacy/"></a>
        </p>
        
        <p>
          
          Powered by
          <a href="https://themefisher.com" target="_blank" rel="noopener">themefisher</a> for
          <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.
        </p>
      </div>
      <div class="col-md-6">
        <ul class="list-inline network-icon text-right">
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="list-inline-item">
            <a href="https://twitter.com/Twitter" target="_blank" rel="noopener" title="DM Me"><i class="fab fa-twitter" aria-hidden="true"></i></a>
          </li>
          
          
          
          
          
          
          
          
          
          
          <li class="list-inline-item">
            <a href="skype:echo123?call"  title="Skype Me"><i class="fab fa-skype" aria-hidden="true"></i></a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="list-inline-item">
            <a href="https://keybase.io/" target="_blank" rel="noopener" title="Chat on Keybase"><i class="fab fa-keybase" aria-hidden="true"></i></a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="list-inline-item">
            <a href="https://discourse.gohugo.io" target="_blank" rel="noopener" title="Discuss on Forum"><i class="fas fa-comments" aria-hidden="true"></i></a>
          </li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>

    </main>
  </div>
</div>


      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
      

      
      
    

    
    
      <script async defer src="//maps.googleapis.com/maps/api/js?key=AIzaSyBu5nZKbeK-WHQ70oqOWo-_4VmwOwKP9YQ"></script>
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
      
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academia.min.7276a6a3624de715a5c7f54c7c07696d.js"></script>

    






  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
